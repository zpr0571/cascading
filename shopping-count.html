<!DOCTYPE HTML>
<html>
<head>
<title>实现购物车客户端计算</title>
<meta charset="utf-8" />
<style>
	table{width:600px; text-align:center;
		border-collapse:collapse;
	}
	td,th{border:1px solid black}
	td[colspan="3"]{text-align:right;}
</style>
</head>
<body>
	<!--this,父级标签-->
	<table id="data">
		<thead>
			<tr>
				<th>商品名称</th>
				<th>单价</th>
				<th>数量</th>
				<th>小计</th>
			</tr>
		</thead>
		<tbody>
			<tr>
				<td>iPhone6</td>
				<td>&yen;4000</td>
				<td>
					<button onclick="calc(this)">-</button>
					<span>1</span>
					<button onclick="calc(this)">+</button>
				</td>
				<td class="last_count">&yen;4000</td>
			</tr>
			
			<tr>
				<td>iPhone6 plus</td>
				<td>&yen;5000</td>
				<td>
				<button onclick="calc(this)">-</button>
				<span>1</span>
				<button onclick="calc(this)">+</button>
				</td>
				<td class="last_count">&yen;5000</td>
			</tr>
			
			<tr>
				<td>iPhone7 plus</td>
				<td>&yen;6000</td>
				<td>
				<button onclick="calc(this)">-</button>
				<span>1</span>
				<button onclick="calc(this)">+</button>
				</td>
				<td class="last_count">&yen;6000</td>
			</tr>
			
		</tbody>
		<tfoot>
			<tr>
				<td colspan="3">Total: </td>
				<td class="sum"></td>
			</tr>
		</tfoot>
	</table>
	
	<script>     
	var list=document.getElementsByClassName('last_count')
	var sum_all=0;
	for (var i = 0; i < list.length; i++) {
		sum_all+=parseInt(list[i].innerHTML.slice(1))
		
	}
	console.log(sum_all+'------------*')
	document.getElementsByClassName('sum')[0].innerHTML='¥'+sum_all;
	
	
function calc (obj) {//统计方法
	var a=obj.parentNode.children[1].innerText;//获得数量
	a=a*1;
	//console.log(a);
	
	if(obj.innerHTML=="+"){//判断+   -
		obj.parentNode.children[1].innerText=a+1
	
	}else{
		if(a>1){//最小为1  不能为0
			obj.parentNode.children[1].innerText=a-1
		}
	}
	//var b=a+1
	 b=obj.parentNode.children[1].innerText;//获得新的数量
	b=b*1;
	//console.log(b);
	//slice(1)截取 字符串
	//获取单价
	var dj=obj.parentNode.parentNode.children[1].innerHTML.slice(1);
	dj=dj*1;
	
	var sum=obj.parentNode.parentNode.children[3];

	sum.innerHTML='¥'+b*dj//每一行的 总价
	
	var list=document.getElementsByClassName('last_count')
	
	var sum_all=0;
	for (var i = 0; i < list.length; i++) {
		sum_all+=parseInt(list[i].innerHTML.slice(1))		
	}
	
	console.log(sum_all+'------------*')
	document.getElementsByClassName('sum')[0].innerHTML='¥'+sum_all;
}
	</script>
</body>
</html>
